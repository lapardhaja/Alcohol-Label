# TTB Label Verification - Rule thresholds and patterns
# Tune these without code changes.

similarity:
  brand_class_pass: 0.90
  brand_class_review: 0.70
  token_containment_score: 0.95
  fuzzy_token_threshold: 0.85
  # Single-token labels that are too generic to confirm a multi-token brand (e.g. "BREWERY" vs "Malt & Hop Brewery")
  generic_brand_tokens: [brewery, distillery, winery, inc, co, company, llc, ale, beer, spirits, beverage, beverages]

abv:
  pattern: '\d+(\.\d+)?\s*%\s*(Alc\.?/?Vol\.?|ALC/?VOL|Alcohol by volume)?'
  proof_pattern: '\d+\s*(Proof|PROOF)'

# TTB net contents: 27 CFR 5.203 standard of fill (metric).
net_contents:
  pattern: '(\d+(?:\.\d+)?)\s*(mL\.?|ml\.?|ML\.?|L\.?|litre|liter)'
  standard_of_fill_ml: [50, 100, 200, 355, 375, 500, 700, 720, 750, 900, 1000, 1750, 1800]

warning:
  government_warning_lead: "GOVERNMENT WARNING:"
  full_statement: |
    GOVERNMENT WARNING: (1) According to the Surgeon General, women should not drink alcoholic beverages during pregnancy because of the risk of birth defects. (2) Consumption of alcoholic beverages impairs your ability to drive a car or operate machinery, and may cause health problems.
  normalize_whitespace: true

origin:
  bottler_patterns:
    - "Distilled and Bottled by"
    - "Bottled by"
    - "Distilled by"
    - "Produced by"
    - "Produced and Bottled by"
    - "Cellared and Bottled by"
    - "Vinted and Bottled by"
    - "Blended and Bottled by"
  importer_patterns:
    - "Imported by"
    - "Sole agent"
  country_pattern: "Product of (.+)"

# Class / type keywords used for extraction and validation.
class_type_keywords:
  # Distilled Spirits (27 CFR Part 5 / TTB Spirits BAM Ch4)
  - Vodka
  - Gin
  - Distilled Gin
  - Compounded Gin
  - Redistilled Gin
  - Rum
  - Tequila
  - Mezcal
  - Whiskey
  - Whisky
  - Bourbon
  - Bourbon Whisky
  - Bourbon Whiskey
  - Rye Whisky
  - Rye Whiskey
  - Wheat Whisky
  - Wheat Whiskey
  - Malt Whisky
  - Malt Whiskey
  - Corn Whisky
  - Corn Whiskey
  - Straight Bourbon Whisky
  - Straight Bourbon Whiskey
  - Straight Rye Whisky
  - Straight Rye Whiskey
  - Straight Wheat Whisky
  - Straight Wheat Whiskey
  - Straight Malt Whisky
  - Straight Malt Whiskey
  - Straight Corn Whisky
  - Straight Corn Whiskey
  - Straight Whisky
  - Straight Whiskey
  - Light Whisky
  - Light Whiskey
  - Blended Whisky
  - Blended Whiskey
  - Blended Bourbon Whisky
  - Blended Bourbon Whiskey
  - Blended Rye Whisky
  - Blended Rye Whiskey
  - Spirit Whisky
  - Spirit Whiskey
  - Scotch Whisky
  - Irish Whiskey
  - Canadian Whisky
  - Kentucky Straight Bourbon Whiskey
  - Tennessee Whiskey
  - Single Malt
  - Single Barrel
  - Single Pot Still
  - Brandy
  - Cognac
  - Armagnac
  - Calvados
  - Pisco
  - Grappa
  - Fruit Brandy
  - Applejack
  - Liqueur
  - Cordial
  - Sloe Gin
  - Amaretto
  - Triple Sec
  - Sambuca
  - Absinthe
  - Bitters
  - Aquavit
  - Neutral Spirits
  - Grain Spirits
  # Wine (27 CFR Part 4 / TTB Wine BAM Ch5)
  - Table Wine
  - Light Wine
  - Dessert Wine
  - Red Wine
  - Rose Wine
  - White Wine
  - Sparkling Wine
  - Champagne
  - Carbonated Wine
  - Fortified Wine
  - Sherry
  - Port
  - Madeira
  - Marsala
  - Vermouth
  - Sake
  - Mead
  - Honey Wine
  - Fruit Wine
  - Citrus Wine
  - Berry Wine
  - Agricultural Wine
  - Retsina
  - Natural Wine
  - Special Natural Wine
  # Beer / Malt Beverages (27 CFR Part 7)
  - Beer
  - Ale
  - Lager
  - Stout
  - Porter
  - Pale Ale
  - India Pale Ale
  - IPA
  - Barleywine Ale
  - Barleywine
  - Barley Wine
  - Pilsner
  - Wheat Beer
  - Hefeweizen
  - Kolsch
  - Saison
  - Sour
  - Gose
  - Malt Liquor
  - Malt Beverage
  - Flavored Malt Beverage
  - Hard Seltzer
  - Hard Cider
  # Other
  - Shochu
  - Baijiu
  - Cachaca

# 27 CFR 5.40(a): Age statement required for whisky aged < 4 years; optional for 4+ years.
# Applies to any whisky, including blends (youngest in blend).
age_statement:
  whisky_age_threshold_years: 4

# Spirit class â†’ required conditionals (27 CFR Part 5).
# Note: age_statement for whisky is now age-based per 5.40(a), not class-based.
spirit_class_rules:
  straight_whiskey:
    keywords:
      - "Straight Bourbon"
      - "Straight Rye"
      - "Straight Wheat"
      - "Straight Malt"
      - "Straight Corn"
      - "Straight Whiskey"
      - "Straight Whisky"
    require: [state_of_distillation]
  bourbon:
    keywords: ["Bourbon"]
    require: [state_of_distillation]
  tennessee:
    keywords: ["Tennessee Whiskey", "Tennessee Whisky"]
    require: [state_of_distillation]
  neutral_spirits:
    keywords: ["Vodka", "Neutral Spirits", "Grain Spirits"]
    require: [neutral_spirits]
  scotch:
    keywords: ["Scotch Whisky", "Scotch"]
    require: [country_of_origin]

conditional_statements:
  sulfites: "Contains sulfites"
  fd_c_yellow_5: "FD&C Yellow No. 5"
  carmine: "Carmine"
  wood_treatment: "Treated with"
  age_statement: "aged"
  neutral_spirits: "neutral spirits"

# Per-beverage-type mandatory / conditional rule configuration
beverage_types:
  spirits:
    mandatory:
      - brand_name
      - class_type
      - alcohol_content
      - net_contents
      - bottler_producer
      - government_warning
    conditional:
      - proof
      - country_of_origin
      - state_of_distillation
      - age_statement
      - commodity_statement
      - coloring_materials
      - wood_treatment
      - fd_c_yellow_5
      - sulfites
    abv_mandatory: true
    proof_optional: true
  wine:
    mandatory:
      - brand_name
      - class_type
      - alcohol_content
      - net_contents
      - bottler_producer
      - government_warning
    conditional:
      - country_of_origin
      - appellation
      - varietal
      - vintage_date
      - sulfites
      - fd_c_yellow_5
      - cochineal_carmine
    abv_mandatory: true
    sulfites_default: true
  beer:
    mandatory:
      - brand_name
      - class_type
      - net_contents
      - bottler_producer
      - government_warning
    conditional:
      - alcohol_content
      - country_of_origin
      - fd_c_yellow_5
      - cochineal_carmine
      - sulfites
      - aspartame
    abv_mandatory: false
